#!/bin/bash

# Copied from: https://stackoverflow.com/questions/8880603/loop-through-an-array-of-strings-in-bash
function installPlugins() {
    WPCLI="$1"
    # Take the top 20 plugins: https://themegrill.com/blog/best-wordpress-plugins/
    # Add top 15: https://www.hostgator.com/blog/most-popular-wordpress-plugins/
    declare -a arr=(
             "akismet"
	     "duplicator"
	     )

    ## now loop through the above array
    for i in "${arr[@]}"
    do
       echo "Installing $i"
       $WPCLI plugin install --activate $i
       # or do whatever with individual element of the array
    done
}
    
WPCLI="/usr/local/bin/php /usr/local/bin/wp.phar --allow-root"

cd /wordpress


echo "Initializing Wordpress root site..."

$WPCLI core install --url=$WP_SLUG --title="CwE-94" --admin_user="admin" --admin_email="support@polyscripted.com" --admin_password="f1amb0yant"

$WPCLI user create author example@polyverse.io --role='author' --user_pass="haveAWr1ter"
$WPCLI user create contributor example1@polyverse.io --role='contributor' --user_pass="haveSomeC0ntent"

$WPCLI rewrite structure '/%postname%'

echo "Installing plugins..."
installPlugins "$WPCLI"
